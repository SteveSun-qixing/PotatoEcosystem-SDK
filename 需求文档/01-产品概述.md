# SDK - 产品概述

**版本**: 1.0.0  
**更新日期**: 2026-01-31  
**状态**: 正式版

---

## 1. 产品定位

### 1.1 核心定位

薯片开发工具包（Chips SDK）是薯片生态的**开发者工具包**,为第三方开发者提供封装良好的高层 API,简化薯片应用和插件的开发。

**三个核心定位**:
1. **能力封装层**: 封装薯片内核和公共基础层的能力
2. **友好接口层**: 提供简洁、易用的开发接口
3. **集成工具包**: 让第三方软件轻松集成薯片能力

### 1.2 架构位置

```
┌─────────────────────────────────────────┐
│       第三方应用 / 插件开发者            │
├─────────────────────────────────────────┤
│          SDK (开发工具包)                │
│      提供友好的高层 API                   │
├─────────────────────────────────────────┤
│      公共基础层 (Chips-Foundation)       │
│    通用功能模块(媒体、文本、文件等)        │
├─────────────────────────────────────────┤
│        薯片微内核 (Chips Core)           │
│      中心路由 | 模块管理 | 生命周期        │
└─────────────────────────────────────────┘
```

### 1.3 目标用户

**主要用户群体**:
- 插件开发者: 开发基础卡片、布局插件、主题包
- 应用开发者: 基于薯片构建完整应用
- 集成开发者: 在现有软件中集成薯片能力
- 工具开发者: 开发薯片相关的辅助工具

**用户技能**:
- 熟悉 TypeScript/JavaScript
- 了解异步编程
- 理解组件化开发
- 对薯片生态有基本了解

---

## 2. 核心价值

### 2.1 对开发者的价值

**简化开发复杂度**:
- 无需了解底层通信协议,直接调用高层 API
- 无需处理文件格式解析,SDK 自动处理
- 无需管理资源加载,SDK 统一管理
- 无需实现渲染逻辑,SDK 提供渲染引擎

**提升开发效率**:
- 几行代码即可实现复杂功能
- 完整的 TypeScript 类型定义
- 丰富的示例代码和文档
- 开箱即用的常用功能

**确保代码质量**:
- 统一的错误处理机制
- 完整的日志记录系统
- 标准化的开发规范
- 高测试覆盖率

**降低学习成本**:
- 清晰的 API 设计
- 详细的开发文档
- 完整的教程和示例
- 活跃的社区支持

### 2.2 对生态系统的价值

**统一开发体验**:
- 所有插件使用相同的 SDK
- 一致的接口风格和命名
- 统一的开发工具链
- 标准化的发布流程

**加速生态发展**:
- 降低插件开发门槛
- 吸引更多开发者参与
- 促进优质插件的诞生
- 扩大生态影响力

**保障质量标准**:
- SDK 强制执行生态规范
- 自动处理复杂的底层细节
- 提供最佳实践指导
- 减少开发者犯错机会

### 2.3 对最终用户的价值（间接）

虽然用户不直接使用 SDK,但 SDK 的质量直接影响用户体验:

- **丰富的插件**: 降低开发门槛带来更多优质插件
- **稳定的体验**: SDK 统一处理错误和异常
- **快速的性能**: SDK 内置性能优化
- **一致的交互**: 所有插件遵循相同的交互模式

---

## 3. 产品边界

### 3.1 SDK 职责（应该做的）

**核心封装**:
- ✅ 封装薯片内核的路由通信
- ✅ 封装公共基础层的功能模块
- ✅ 提供友好的高层 API
- ✅ 处理底层通信细节

**开发支持**:
- ✅ 提供完整的类型定义
- ✅ 提供开发工具和脚手架
- ✅ 提供调试和日志工具
- ✅ 提供示例代码和文档

**业务逻辑**:
- ✅ 卡片和箱子的文件操作
- ✅ 卡片的渲染管理
- ✅ 插件的加载和管理
- ✅ 主题的切换和应用
- ✅ 资源的统一访问

**标准执行**:
- ✅ 强制执行生态开发规范
- ✅ 验证文件格式正确性
- ✅ 处理多语言翻译
- ✅ 管理配置层级

### 3.2 非 SDK 职责（不应该做的）

**底层实现**（由 Core 和 Foundation 提供）:
- ❌ 不实现中心路由系统
- ❌ 不实现模块生命周期管理
- ❌ 不实现文件识别和类型判断
- ❌ 不实现资源缓存和下载
- ❌ 不实现媒体播放和渲染
- ❌ 不实现文本解析和高亮

**具体插件功能**（由各插件实现）:
- ❌ 不实现具体的卡片类型
- ❌ 不实现具体的布局算法
- ❌ 不实现具体的编辑功能
- ❌ 不实现具体的主题样式

**应用层功能**（由应用实现）:
- ❌ 不提供完整的编辑器界面
- ❌ 不提供完整的查看器界面
- ❌ 不处理用户账户和认证
- ❌ 不处理数据同步和备份

### 3.3 边界示例

**场景1: 开发者想播放视频卡片**
- ✅ SDK 职责: 提供 `sdk.renderCard()` API,加载卡片配置
- ✅ Foundation 职责: 实际的视频解码和播放
- ❌ 非 SDK 职责: 视频编辑、特效处理

**场景2: 开发者想保存卡片**
- ✅ SDK 职责: 提供 `sdk.saveCard()` API,组织文件结构
- ✅ Foundation 职责: ZIP 文件的创建和写入
- ❌ 非 SDK 职责: 云端同步、版本管理

**场景3: 开发者想切换主题**
- ✅ SDK 职责: 提供 `sdk.setTheme()` API,应用主题变量
- ✅ Foundation 职责: CSS 变量的实际更新
- ❌ 非 SDK 职责: 主题的具体样式定义

---

## 4. 技术定位

### 4.1 技术栈

**编程语言**:
- TypeScript 5.0+ (主要开发语言)
- 提供完整的类型定义
- 支持 JavaScript 项目使用

**运行环境**:
- Web 浏览器 (Chrome 90+, Firefox 88+, Safari 14+, Edge 90+)
- Node.js 16.0+
- Electron 20.0+

**依赖关系**:
```
SDK 1.0.0
  ├── @chips/core: ^1.0.0 (薯片内核)
  └── @chips/foundation: ^1.0.0 (公共基础层)
```

### 4.2 设计原则

**简洁优先**:
- API 设计简单直观
- 常用功能开箱即用
- 隐藏底层复杂性

**类型安全**:
- 完整的 TypeScript 类型
- 编译时错误检查
- 自动补全和提示

**异步优先**:
- 所有 I/O 操作异步
- 使用 async/await
- Promise 风格 API

**链式调用**:
- 支持方法链式调用
- 提升代码可读性
- 减少中间变量

**事件驱动**:
- 提供完整的事件系统
- 支持事件监听和取消
- 便于扩展和集成

### 4.3 性能要求

**启动性能**:
- SDK 初始化时间 < 200ms
- 首次 API 调用响应 < 100ms

**运行性能**:
- 文件加载时间 < 500ms (< 10MB)
- 渲染响应时间 < 300ms
- 内存占用 < 100MB (基础使用)

**打包体积**:
- SDK 核心 < 500KB (压缩后)
- 包含类型定义 < 800KB
- 完整包 < 2MB

---

## 5. 核心功能

### 5.1 文件操作

```typescript
// 加载卡片
const card = await sdk.loadCard('path/to/card.card');

// 保存卡片
await sdk.saveCard(card, 'output.card');

// 批量加载
const cards = await sdk.loadCards(['card1.card', 'card2.card']);

// 加载箱子
const box = await sdk.loadBox('path/to/box.box');
```

### 5.2 渲染功能

```typescript
// 基础渲染
await sdk.renderCard(card, '#container');

// 高级渲染
await sdk.renderCard(card, '#container', {
  theme: 'dark',
  readOnly: true,
  interactive: true,
  lazyLoad: true
});

// 渲染箱子
await sdk.renderBox(box, '#container', {
  layout: 'waterfall',
  columns: 3
});
```

### 5.3 插件系统

```typescript
// 注册插件
await sdk.registerPlugin(myPlugin);

// 获取插件
const plugin = sdk.getPlugin('publisher:plugin-name');

// 列出插件
const plugins = sdk.listPlugins({ type: 'base_card' });
```

### 5.4 主题系统

```typescript
// 设置主题
sdk.setTheme('dark');

// 注册主题
sdk.registerTheme(customTheme);

// 获取主题
const theme = sdk.getTheme('my-theme');
```

### 5.5 事件系统

```typescript
// 监听事件
sdk.on('card:load', (card) => {
  console.log('卡片已加载:', card.metadata.name);
});

// 触发事件
sdk.emit('custom:event', { data: 'value' });

// 取消监听
sdk.off('card:load', handler);
```

---

## 6. 使用场景

### 6.1 插件开发

开发者使用 SDK 创建各种插件:

```typescript
import { BaseCardPlugin } from '@chips/sdk';

export class MyCardPlugin extends BaseCardPlugin {
  metadata = {
    id: 'my:card-plugin',
    name: '我的卡片',
    version: '1.0.0'
  };
  
  async render(config, container) {
    // 使用 SDK 提供的能力
    const resource = await this.sdk.loadResource(config.image);
    container.appendChild(resource);
  }
}
```

### 6.2 应用集成

在现有应用中集成薯片能力:

```typescript
import { ChipsSDK } from '@chips/sdk';

// 在博客系统中显示卡片
const sdk = new ChipsSDK();
const card = await sdk.loadCard(cardUrl);
await sdk.renderCard(card, '#article-content');
```

### 6.3 工具开发

开发薯片相关的辅助工具:

```typescript
// 卡片格式转换工具
const sdk = new ChipsSDK();
const card = await sdk.loadCard('old-format.card');
await sdk.saveCard(card, 'new-format.card', {
  version: '1.0.0'
});
```

---

## 7. 成功标准

### 7.1 技术指标

**开发体验**:
- ✅ 5分钟完成首个示例
- ✅ API 学习曲线平缓
- ✅ 完整的类型支持
- ✅ 丰富的示例代码

**代码质量**:
- ✅ 测试覆盖率 ≥ 85%
- ✅ 零已知安全漏洞
- ✅ 所有 API 有文档
- ✅ 代码审查通过率 100%

**性能表现**:
- ✅ 启动时间 < 200ms
- ✅ API 响应时间 < 100ms
- ✅ 内存占用 < 100MB
- ✅ 打包体积 < 2MB

### 7.2 生态指标

**开发者采用**:
- ✅ 发布后 3 个月内有 100+ 个插件使用
- ✅ GitHub Stars ≥ 500
- ✅ NPM 周下载量 ≥ 1000

**社区活跃度**:
- ✅ 活跃的 GitHub Discussions
- ✅ 及时的 Issue 响应（< 48小时）
- ✅ 定期的版本更新

### 7.3 质量指标

**文档完善度**:
- ✅ API 文档覆盖率 100%
- ✅ 至少 20 个完整示例
- ✅ 完整的开发指南
- ✅ 多语言文档支持

**兼容性**:
- ✅ 支持主流浏览器
- ✅ 支持 Node.js 16+
- ✅ 支持 Electron 20+
- ✅ 向后兼容承诺

---

## 8. 版本规划

### 8.1 v1.0.0（当前版本）

**核心功能**:
- 文件操作 API
- 渲染引擎封装
- 插件系统基础
- 主题系统基础
- 事件系统
- 完整文档

**目标**:
- 提供稳定的核心 API
- 覆盖常见使用场景
- 建立良好的开发者口碑

### 8.2 v1.x（功能增强）

**计划功能**:
- 可视化编辑器 API
- 协作功能支持
- 更丰富的工具方法
- 性能优化

### 8.3 v2.0（未来规划）

**潜在方向**:
- 云端集成
- 移动端优化
- AI 辅助功能
- 实时协作

---

## 9. 与其他模块的关系

### 9.1 依赖关系

**必需依赖**:
- `@chips/core`: 薯片微内核,提供中心路由
- `@chips/foundation`: 公共基础层,提供通用功能

**可选依赖**:
- 各类插件包
- 各类主题包

### 9.2 被依赖关系

**被依赖方**:
- 所有插件开发
- 所有应用开发
- 所有工具开发

### 9.3 协作关系

**与 Core 的协作**:
- SDK 通过 Core 的路由系统访问 Foundation
- SDK 通过 Core 注册和管理插件
- SDK 通过 Core 监听系统事件

**与 Foundation 的协作**:
- SDK 调用 Foundation 的文件处理能力
- SDK 调用 Foundation 的媒体处理能力
- SDK 调用 Foundation 的文本处理能力
- SDK 调用 Foundation 的资源管理能力

---

## 10. 文档说明

本文档是薯片 SDK 需求规格说明书的第一部分,主要阐述产品的定位、价值和边界。后续文档将详细描述:

- **02-功能需求.md**: 详细的功能需求列表
- **03-API需求.md**: 核心 API 接口定义
- **04-集成需求.md**: 与其他模块的集成方式
- **05-非功能需求.md**: 性能、安全、可靠性等要求

配套的技术文档位于 `技术文档/` 目录,包含架构设计、接口定义、实现规范等详细的技术文档。

---

**文档维护者**: Chips 生态核心团队  
**反馈渠道**: 提交 Issue 到官方仓库
